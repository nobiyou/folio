# 发布检查清单（通用版）

## 1. 发布前自动门禁（必须通过）
1. 在项目根目录执行：
   - `powershell -ExecutionPolicy Bypass -File scripts/release-gate.ps1`
2. 通过标准：
   - PHP 语法检查全部通过
   - 关键 JS 语法检查通过
   - 国际化扫描通过（不允许新增可翻译中文硬编码）
   - 当前工作区状态已输出，便于发布记录

## 2. 发布前手工回归（必须通过）
1. 前台功能：
   - 首页、归档、文章详情可正常访问
   - 点赞、收藏、分享正常
   - 会员受限内容提示与预览逻辑正确
2. 用户中心：
   - 登录、注册、退出
   - 会员页面显示与升级入口
   - 通知页单条已读、全部已读、删除
   - 收藏页增删收藏
3. 后台功能：
   - 主题设置页可打开并保存
   - 会员系统各标签页可用
   - 安全防护页无报错
   - 性能/缓存页按钮无 nonce 误报
4. 国际化抽样：
   - 中文站点关键页面中文显示正常
   - 英文站点关键页面英文显示正常

## 3. 打包发布（包含最新工作区）
1. 执行打包：
   - `powershell -ExecutionPolicy Bypass -File scripts/release-package.ps1`
2. 产物说明：
   - 输出路径：`dist_pkg/folio-full-workingtree-时间戳.zip`
   - 包含当前最新修改（非仅 `git HEAD`）
   - 默认排除：`.git`、`node_modules`、`dist`、`dist_pkg`

## 4. 发布后观察（建议）
1. 观察 PHP 错误日志：
   - 是否出现新的 fatal / warning
2. 观察关键接口：
   - 登录/会员/通知/缓存相关 AJAX 是否出现异常 403/500
3. 观察业务指标：
   - 通知未读数、会员权限、缓存命中是否异常波动

## 5. 快速回滚预案
1. 保留上一个可用主题包（zip）用于秒级回滚
2. 回滚后执行：
   - 清理对象缓存/页面缓存
   - 重新验证登录、会员权限、通知、缓存页面

## 6. 关联文档
- `docs/I18N-AUDIT.md`
- `docs/BUG-AUDIT.md`
- `docs/REFACTOR-NOTES.md`
